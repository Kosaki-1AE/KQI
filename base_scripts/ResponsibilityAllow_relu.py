import numpy as np


# ç·šå½¢å¤‰æ›ï¼ˆè²¬ä»»ãƒ™ã‚¯ãƒˆãƒ«ã‚’æŠ•å½±ã™ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰ã“ã‚Œã§è¦å®šã ã‘æ•´ãˆã¾ã£ã™
def linear_transform(x, W, b):
    return np.dot(x, W) + b

# ReLUï¼ˆæ­£ã®è²¬ä»»ã ã‘é€šã™ï¼‰æ„›ã‚’ç™ºç”Ÿã•ã›ã‚‹è²¬ä»»ãƒ™ã‚¯ãƒˆãƒ«ãŒã“ã£ã¡
def relu(x):
    return np.maximum(0, x)

# é€†ReLUï¼ˆè² ã®è²¬ä»»ã ã‘é€šã™ï¼‰ãˆãã¿ã‚’ç™ºç”Ÿã•ã›ã‚‹è²¬ä»»ãƒ™ã‚¯ãƒˆãƒ«ãŒã“ã£ã¡
def neg_relu(x):
    return np.minimum(0, x)

# å…¥åŠ›ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆè²¬ä»»ãƒ™ã‚¯ãƒˆãƒ«çš„ãªã‚‚ã®ï¼‰ä¸€å¿œã¯å¤–éƒ¨ã‹ã‚‰ä¸ãˆã‚‰ã‚Œã‚‹ã‚‚ã®
x = np.array([1.0, -2.0, 3.0])

# é‡ã¿è¡Œåˆ—ã¨ãƒã‚¤ã‚¢ã‚¹
W = np.array([[0.5, -1.0, 0.3],
              [0.8,  0.2, -0.5],
              [-0.6, 0.4,  1.0]])
b = np.array([0.1, -0.2, 0.3])

# ç·šå½¢å¤‰æ›ï¼ˆã“ã£ã¡ãŒæœ¬å‘½ã­ï¼‰
z = linear_transform(x, W, b)

# æ´»æ€§åŒ–é–¢æ•°ã®ä¸¡æ–¹ã‚’é©ç”¨
out_relu = relu(z)
out_neg_relu = neg_relu(z)
out_neg_abs = np.abs(out_neg_relu)   # ğŸ‘ˆ çµ¶å¯¾å€¤ã«å¤‰æ›
# çµ±åˆï¼ˆæ„› + ã‚¨ã‚°ã¿ã‚’æ­£ã«ã—ãŸã‚‚ã®ï¼‰ã“ã‚Œã¯å‡¦ç†ã¨ã—ã¦å¿…è¦ã«ãªã‚‹ã‹ã‚‚ã¨æ€ã£ã¦å…¥ã‚Œã¦ã¾ã™
out_combined = out_relu + out_neg_abs

print("å…¥åŠ›ãƒ™ã‚¯ãƒˆãƒ«:", x)
print("ç·šå½¢å¤‰æ›å¾Œ:", z)
print("ReLUçµæœ (æ­£ã®è²¬ä»»ï¼šæ„›):", out_relu)
print("é€†ReLUçµæœ (è² ã®è²¬ä»»ï¼šãˆãã¿):", out_neg_relu)
print("é€†ReLUã®çµ¶å¯¾å€¤ (è² ã®å¼·ã•):", out_neg_abs)  # ã“ã“ãŒã€Œã‚¨ã‚°ã¿ã®å¼·ã•ã€
print("ReLUã¨é€†ReLUã®å’Œï¼ˆå…¨ä½“ã®è²¬ä»»ï¼‰:", out_relu + out_neg_relu)  # å…ƒã®ç·šå½¢å¤‰æ›çµæœã«æˆ»ã‚‹ã¯ãš
print("ReLUã¨é€†ReLUã®å·®ï¼ˆå®‰å…¨åœ°å¸¯ã®å¹…ã®åºƒã•ï¼‰:", out_relu - out_neg_relu)  # ã“ã‚Œã¯çµ±åˆã®ã‚„ã¤ã¨åŒã˜ã“ã¨ã—ã¦ã‚‹ã®ã‚ˆã­
print("ç©(å•†ã¯ã‚ã‚“ã¾æ„å‘³ãªã„å¯èƒ½æ€§ãŒã‚ã‚‹):", out_relu * out_neg_relu)
print()
print("ãªãŠæ„›ã¨ãˆãã¿ã®æ¯”è¼ƒãŒã“ã¡ã‚‰:")

for i, (pos, neg) in enumerate(zip(out_relu, out_neg_abs)):
    if pos > neg:
        result = "æ„›ãŒå„ªå‹¢"
    elif pos < neg:
        result = "ã‚¨ã‚°ã¿ãŒå„ªå‹¢"
    else:
        result = "æ‹®æŠ—"
    print(f"æˆåˆ†{i}: æ­£={pos:.2f}, è² (å¼·ã•)={neg:.2f} â†’ {result}")
print()
print("ã‚ˆã£ã¦ãƒ€ãƒ³ã‚µãƒ¼ãŒã©ã†ã„ã†é…åˆ†ã«è¦‹ãˆã‚‹ã‹ã¨ã„ã†ã¨ï¼ˆæ„Ÿè¦šæ´¾ã®äººé–“ãŒæ›²èã„ãŸæ™‚ã®æµã‚Œçš„ã«ã€Œã“ã†ã˜ã‚ƒã­ï¼Ÿã€ã£ã¦æ€ã†ã®ã‚’æ•°å€¤åŒ–ã™ã‚‹ã¨ï¼‰:", out_combined)